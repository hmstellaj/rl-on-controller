# ğŸš€ Tank Navigation with Reinforcement Learning

Unity ì‹œë®¬ë ˆì´í„° ê¸°ë°˜ ì „ì°¨ ììœ¨ì£¼í–‰ ì‹œìŠ¤í…œ  
**A* ê²½ë¡œ ê³„íš + RL êµ­ì†Œ ì œì–´** í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
tank_rl/
â”œâ”€â”€ rl_environment.py      # Gymnasium í™˜ê²½ (í•™ìŠµìš©)
â”œâ”€â”€ rl_controller.py       # RL ì»¨íŠ¸ë¡¤ëŸ¬ (ì¶”ë¡ ìš©)
â”œâ”€â”€ train_rl.py            # í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ server_rl.py           # Flask ì„œë²„ (ì‹œë®¬ë ˆì´í„° ì—°ë™)
â””â”€â”€ env_data/              # í•™ìŠµ í™˜ê²½ ë°ì´í„°
  â”œâ”€â”€ ob_v2.json           # ì¥ì• ë¬¼ ë°ì´í„°
  â”œâ”€â”€ height_map.npy       # ë†’ì´ ë§µ
  â””â”€â”€ slope_costmap.npy    # ê²½ì‚¬ë„ ë§µ
â””â”€â”€ models/                # í•™ìŠµëœ ëª¨ë¸ ì €ì¥ ìœ„ì¹˜
    â””â”€â”€ tank_nav_final.zip
```

---

## ğŸ§  ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Unity ì‹œë®¬ë ˆì´í„°                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ REST API (~5Hz)
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Flask Server (server_rl.py)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   [A* í”Œë˜ë„ˆ]  â”€â”€waypointsâ”€â”€â–º  [RL ì»¨íŠ¸ë¡¤ëŸ¬]  â”€â”€ëª…ë ¹â”€â”€â–º     â”‚
â”‚       â”‚                            â”‚                        â”‚
â”‚   ì „ì—­ ê²½ë¡œ ìƒì„±              êµ­ì†Œ ì œì–´ ê²°ì •                 â”‚
â”‚   (ì¥ì• ë¬¼ íšŒí”¼)              (ë¶€ë“œëŸ¬ìš´ ì¡°í–¥)                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### RL ì—ì´ì „íŠ¸ ì—­í• 

| êµ¬ë¶„ | A* í”Œë˜ë„ˆ | RL ì—ì´ì „íŠ¸ |
|------|-----------|-------------|
| ì—­í•  | ì „ì—­ ê²½ë¡œ ìƒì„± | êµ­ì†Œ ì œì–´ |
| ì…ë ¥ | ì‹œì‘ì , ëª©ì ì§€, ì¥ì• ë¬¼ | í˜„ì¬ ìƒíƒœ, íƒ€ê²Ÿ, ë¼ì´ë‹¤ |
| ì¶œë ¥ | waypoint ë¦¬ìŠ¤íŠ¸ | W/A/D/STOP ëª…ë ¹ |
| íŠ¹ì§• | ìµœì  ê²½ë¡œ ë³´ì¥ | ë¶€ë“œëŸ¬ìš´ ì›€ì§ì„, ìƒí™© ì ì‘ |

---

## ğŸ“Š Observation Space (20ì°¨ì›)

```python
observation = [
    heading_error / 180,      # íƒ€ê²Ÿ ë°©í–¥ ì˜¤ì°¨ (-1 ~ 1)
    target_distance / 50,     # íƒ€ê²Ÿê¹Œì§€ ê±°ë¦¬ (0 ~ 1)
    current_speed / max_speed,# í˜„ì¬ ì†ë„ (0 ~ 1)
    goal_distance / 300,      # ëª©í‘œê¹Œì§€ ê±°ë¦¬ (0 ~ 1)
    lidar_ray_0 / 30,         # ë¼ì´ë‹¤ 0Â° (0 ~ 1)
    lidar_ray_1 / 30,         # ë¼ì´ë‹¤ 22.5Â°
    ...                       # ì´ 16ê°œ ë°©í–¥
    lidar_ray_15 / 30,        # ë¼ì´ë‹¤ 337.5Â°
]
```

---

## ğŸ¯ Action Space (6ê°œ ì´ì‚° í–‰ë™)

| Action | ì„¤ëª… | moveWS | moveAD |
|--------|------|--------|--------|
| 0 | ì§ì§„ (ë¹ ë¦„) | W, 0.5 | - |
| 1 | ì „ì§„ + ì¢ŒíšŒì „ | W, 0.35 | A, 0.5 |
| 2 | ì „ì§„ + ìš°íšŒì „ | W, 0.35 | D, 0.5 |
| 3 | ì œìë¦¬ ì¢ŒíšŒì „ | STOP | A, 0.8 |
| 4 | ì œìë¦¬ ìš°íšŒì „ | STOP | D, 0.8 |
| 5 | ì •ì§€ | STOP | - |

---

## ğŸ† Reward Function

```python
def calculate_reward():
    reward = 0
    
    # 1. ëª©í‘œ ë„ë‹¬ (+1000)
    if reached_goal:
        return 1000
    
    # 2. ì¶©ëŒ (-500)
    if collision:
        return -500
    
    # 3. ëª©í‘œ ì ‘ê·¼ (+10 per meter)
    reward += distance_delta * 10
    
    # 4. ì‹œê°„ íŒ¨ë„í‹° (-0.1 per step)
    reward -= 0.1
    
    # 5. ë°©í–¥ ì •ë ¬ ë³´ë„ˆìŠ¤ (+0.5)
    if abs(heading_error) < 15:
        reward += 0.5
    
    # 6. ì†ë„ ë³´ë„ˆìŠ¤ (+0.3)
    if speed > 1.0:
        reward += 0.3
    
    return reward
```

---

## âš™ï¸ í•˜ì´í¼íŒŒë¼ë¯¸í„°

### í•™ìŠµ ì„¤ì • (train_rl.py)

| íŒŒë¼ë¯¸í„° | ê¸°ë³¸ê°’ | ì„¤ëª… |
|----------|--------|------|
| `--timesteps` | 500,000 | ì´ í•™ìŠµ ìŠ¤í… |
| `--n-envs` | 4 | ë³‘ë ¬ í™˜ê²½ ìˆ˜ |
| `--lr` | 3e-4 | í•™ìŠµë¥  |
| `--batch-size` | 64 | ë°°ì¹˜ í¬ê¸° |
| `--gamma` | 0.99 | í• ì¸ìœ¨ |

### í™˜ê²½ ì„¤ì • (rl_environment.py)

| íŒŒë¼ë¯¸í„° | ê°’ | ì„¤ëª… |
|----------|-----|------|
| `goal_threshold` | 8.0m | ëª©í‘œ ë„ë‹¬ íŒì • ê±°ë¦¬ |
| `max_episode_steps` | 1500 | ìµœëŒ€ ì—í”¼ì†Œë“œ ê¸¸ì´ (300ì´ˆ) |
| `lidar_num_rays` | 16 | ê°€ìƒ ë¼ì´ë‹¤ ë ˆì´ ìˆ˜ |
| `lidar_max_range` | 30m | ë¼ì´ë‹¤ ìµœëŒ€ ê±°ë¦¬ |

---

## ğŸ“š ì°¸ê³ 

- [Stable-Baselines3 ë¬¸ì„œ](https://stable-baselines3.readthedocs.io/)
- [Gymnasium ë¬¸ì„œ](https://gymnasium.farama.org/)
- [PPO ë…¼ë¬¸](https://arxiv.org/abs/1707.06347)
